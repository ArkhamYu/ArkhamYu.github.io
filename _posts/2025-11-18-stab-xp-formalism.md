---
layout: post
title: "Note 1: Stabilizer and XP Formalisms"
description: "Worked example of a repetition-code circuit and a short introduction to the XP stabiliser formalism."
tags: [qec-notes, stabilizer, xp-formalism]
categories: [qec]
published: true
thumbnail: /assets/img/qec/stabformalism.png
math: true
---

<style>
  /* 整个笔记块居中、限制宽度 */
  article.post, .post, .post-content {
    max-width: 900px;
    margin: 0 auto;
  }

  /* 正文字号稍微变大一点，行距舒服一点 */
  article.post p,
  article.post li,
  .post p,
  .post li {
    font-size: 1.1rem;
    line-height: 1.7;
  }

  /* ===== 层级 1：大章节标题 (Stabilizer formalism / The XP formalism) ===== */
  article.post h2,
  .post h2 {
    text-align: center;
    margin-top: 2.5rem;
    margin-bottom: 1.2rem;
    font-size: 2rem;
    font-weight: 700;
    /* 深一点的蓝绿墨色，柔和一点 */
    color: #003594;
    font-family: "Roboto Slab", "Times New Roman", serif;
  }

  /* ===== 层级 2：普通小节标题 (如 Vector representation...) 默认样式 ===== */
  article.post h3,
  .post h3 {
    text-align: center;
    margin-top: 2rem;
    margin-bottom: 0.75rem;
    font-size: 1.35rem;
    font-weight: 600;
    /* 稍微偏蓝的深灰色 */
    color: #FFCB05;
    font-family: "Roboto Slab", "Times New Roman", serif;
  }

  /* ===== 层级 2（变体）：Example 小标题，使用一点亮的蓝绿色 ===== */
  .qec-example-heading {
    color: #FFCB05; /* 比 h2 亮、但不刺眼 */
  }

  /* Step 标题（h4）居中，颜色比正文稍深一点 */
  .qec-step h4 {
    text-align: center;
    font-size: 1.1rem;
    font-weight: 600;
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
    font-family: "Roboto Slab", "Times New Roman", serif;
    color: #0820abff;
  }

  /* 图片与图注居中 */
  article.post img,
  .post img {
    display: block;
    margin: 1.5rem auto 0.5rem auto;
  }

  .figure-caption {
    text-align: center;
    font-size: 0.9rem;
    color: #777;
  }

  /* 行间公式上下多留一点空白，并保证在中间 */
  mjx-container[display="true"] {
    margin: 1.4em auto !important;
    text-align: center !important;
    justify-content: center !important;
  }

  /* 自定义分隔线：中间稍微加重，两侧渐隐 */
  .qec-divider {
    border: 0;
    height: 1px;
    max-width: 720px;
    margin: 2.2rem auto;
    background: linear-gradient(
      to right,
      rgba(0,0,0,0),
      rgba(38,70,83,0.4),
      rgba(0,0,0,0)
    );
  }
</style>

## Stabilizer formalism

![Repetition code circuit used to illustrate the stabilizer formalism and measurement constraints.](/assets/img/qec/stabformalism.png)

_Figure 1: Repetition code circuit used to illustrate the stabilizer formalism and measurement constraints._  
{: .figure-caption}

### Example: stabilizer analysis of the circuit in Fig. 1

Label the qubits from top to bottom as $q_1, q_2, q_3, q_4, q_5$.

The initial state is
$$
\lvert 0\rangle_{1}
\otimes \big(a \lvert 000\rangle + b \lvert 111\rangle \big)_{2,3,4}
\otimes \lvert 0\rangle_{5},
$$
whose stabilizer group is generated by

$$
\mathcal{S}_0
  = \big\langle
    Z_1,\;
    Z_5,\;
    Z_2 Z_3,\;
    Z_3 Z_4,\;
    X_2 X_3 X_4
    \big\rangle .
$$

Recall the conjugation action of a CNOT gate
$\mathrm{CX}_{c \to t}$ on single-qubit Pauli operators
(ignoring global phases):

$$
\begin{aligned}
X_c &\mapsto X_c X_t, & Z_c &\mapsto Z_c, \\
X_t &\mapsto X_t,     & Z_t &\mapsto Z_c Z_t .
\end{aligned}
$$

The action on multi-qubit Pauli operators follows by multiplicativity.

<hr class="qec-divider">

#### Step 1: $\mathrm{CX}(q_2 \to q_1)$
<div class="qec-step">


Applying the above rules to each generator in $\mathcal{S}_0$:

$$
\begin{aligned}
Z_1 &\to Z_1 Z_2, \\
Z_5 &\to Z_5, \\
Z_2 Z_3 &\to Z_2 Z_3, \\
Z_3 Z_4 &\to Z_3 Z_4, \\
X_2 X_3 X_4 &\to (X_2 X_1) X_3 X_4 = X_1 X_2 X_3 X_4.
\end{aligned}
$$

Thus

$$
\mathcal{S}_1
  = \big\langle
      Z_1 Z_2,\;
      Z_5,\;
      Z_2 Z_3,\;
      Z_3 Z_4,\;
      X_1 X_2 X_3 X_4
    \big\rangle .
$$

</div>

<hr class="qec-divider">

#### Step 2: $\mathrm{CX}(q_3 \to q_1)$
<div class="qec-step">

$$
\begin{aligned}
Z_1 Z_2 &\to (Z_3 Z_1) Z_2 = Z_1 Z_2 Z_3, \\
Z_5 &\to Z_5, \\
Z_2 Z_3 &\to Z_2 Z_3, \\
Z_3 Z_4 &\to Z_3 Z_4, \\
X_1 X_2 X_3 X_4
  &\to X_1 \cdot (X_3 X_1) \cdot X_2 X_4
   = X_2 X_3 X_4.
\end{aligned}
$$

Thus
$$
\mathcal{S}_2
  = \big\langle
      Z_1 Z_2 Z_3,\;
      Z_5,\;
      Z_2 Z_3,\;
      Z_3 Z_4,\;
      X_2 X_3 X_4
    \big\rangle .
$$
</div>

<hr class="qec-divider">

#### Step 3: $\mathrm{CX}(q_3 \to q_5)$
<div class="qec-step">

$$
\begin{aligned}
Z_1 Z_2 Z_3 &\to Z_1 Z_2 Z_3, \\
Z_5 &\to Z_3 Z_5, \\
Z_2 Z_3 &\to Z_2 Z_3, \\
Z_3 Z_4 &\to Z_3 Z_4, \\
X_2 X_3 X_4
  &\to X_2 \cdot (X_3 X_5) \cdot X_4
   = X_2 X_3 X_4 X_5.
\end{aligned}
$$

Thus
$$
\mathcal{S}_3
  = \big\langle
      Z_1 Z_2 Z_3,\;
      Z_3 Z_5,\;
      Z_2 Z_3,\;
      Z_3 Z_4,\;
      X_2 X_3 X_4 X_5
    \big\rangle .
$$
</div>

<hr class="qec-divider">

#### Step 4: $\mathrm{CX}(q_4 \to q_5)$
<div class="qec-step">

$$
\begin{aligned}
Z_1 Z_2 Z_3 &\to Z_1 Z_2 Z_3, \\
Z_3 Z_5 &\to Z_3 (Z_4 Z_5) = Z_3 Z_4 Z_5, \\
Z_2 Z_3 &\to Z_2 Z_3, \\
Z_3 Z_4 &\to Z_3 Z_4, \\
X_2 X_3 X_4 X_5
  &\to X_2 X_3 (X_4 X_5) X_5
   = X_2 X_3 X_4.
\end{aligned}
$$

Thus the final stabilizer group is
$$
\mathcal{S}_{\mathrm{final}}
  = \big\langle
      Z_1 Z_2 Z_3,\;
      Z_3 Z_4 Z_5,\;
      Z_2 Z_3,\;
      Z_3 Z_4,\;
      X_2 X_3 X_4
    \big\rangle .
$$

</div>

<hr class="qec-divider">

#### Measurement analysis

From $\mathcal{S}_{\mathrm{final}}$ we obtain:

- $Z_1 = (Z_1 Z_2 Z_3)(Z_2 Z_3) \in \mathcal{S}_{\mathrm{final}}$ $\Rightarrow\ M_1 = Z_1$ is deterministic with outcome $+1$.
- $Z_5 = (Z_3 Z_4 Z_5)(Z_3 Z_4) \in \mathcal{S}_{\mathrm{final}}$ $\Rightarrow\ M_2 = Z_5$ is deterministic with outcome $+1$.
- $Z_2 Z_3 = +1$ and $Z_3 Z_4 = +1$ enforce $m_3 \oplus m_4 = 0$ and $m_4 \oplus m_5 = 0$, i.e. $m_3 = m_4 = m_5$.  
  The individual values are random, but subject to these parity constraints.

These parity checks correspond to the two detectors
$(m_3 \oplus m_4)$ and $(m_4 \oplus m_5)$ in the detector error model.

---

## The XP formalism

An XP stabiliser code is defined by fixing an integer $N \geq 2$,
referred to as the **precision** of the code.  
We take stabiliser generators from
$\langle \omega I, X, P \rangle^{\otimes n}$, where
$$
\omega := \exp\!\Big(\frac{\pi i}{N}\Big)
       = \exp\!\Big(\frac{1}{2N}\, 2\pi i\Big),
\qquad
\omega^{2N} = 1,
$$
and
$$
P := \mathrm{diag}(1,\omega^2), \qquad P^N = I.
$$

Each choice of precision $N$ leads to a different stabiliser formalism.  
For example, $N = 2$ corresponds to the standard Pauli stabiliser
formalism, with $\omega = i$ and $Z^2 = I$.

Under conjugation by Hadamard operators, if $N = 2M$ then
$$
H P H^{-1} = \sqrt[M]{X}.
$$

---

### Vector representation of XP operators

Let
$\mathbf{u}
 = (p \mid \mathbf{X} \mid \mathbf{Z})
 \in \mathbb{Z}_{2N} \times \mathbb{Z}_2^n \times \mathbb{Z}_N^n$
be an integer vector of length $2n + 1$.  
The XP operator of precision $N$ corresponding to $\mathbf{u}$ is
$$
XP_N(\mathbf{u})
  := \omega^p \bigotimes_{0 \leq i < n}
       X^{\mathbf{X}[i]} P^{\mathbf{Z}[i]} .
$$

Each component is periodic and can be rewritten as
$$
XP_N(p \mid \mathbf{X} \mid \mathbf{Z})
  = XP_N\big(p \bmod 2N \,\big|\, \mathbf{X} \bmod 2
     \,\big|\, \mathbf{Z} \bmod N\big).
$$

Some useful properties:

1. The identity XP operator is $XP_N(0 \mid \mathbf{0} \mid \mathbf{0})$,
   where $\mathbf{0}$ is the length-$n$ zero vector.
2. Because $\omega^N = -1$, we have
   $XP_N(N \mid \mathbf{0} \mid \mathbf{0}) = -I$.
3. The single-qubit $X$ operator is $XP_N(0 \mid 1 \mid 0)$.
4. Diagonal operators are of the form $XP_N(N \mid \mathbf{0} \mid \mathbf{Z})$.
5. If $N$ is even, the single-qubit $Z$ operator is
   $XP_N(0 \mid 0 \mid N/2)$.  
   For odd $N$, $Z$ operators cannot be represented as XP operators.

The XP formalism has a fundamental commutation relation that allows us
to move $P$ operators to the right of $X$ operators:
$$
P X = \omega^2 X P^{-1}.
$$

The **action of an XP operator** on a computational-basis state
$\lvert \mathbf{e}\rangle$, where
$\mathbf{e} \in \mathbb{Z}_2^n$, is
$$
XP_N(p \mid \mathbf{X} \mid \mathbf{Z})
  \,\lvert \mathbf{e}\rangle
  = \omega^{p + 2\mathbf{e} \cdot \mathbf{Z}}
    \lvert \mathbf{e} \oplus \mathbf{X}\rangle .
$$

---

### Example: an XP operator at precision $N = 8$

Consider
$$
A = XP_8(12 \mid 1110000 \mid 0040000).
$$

The **precision** is specified by the subscript $8$, so $N = 8$.  
Then $\omega = \exp\!\big(\tfrac{1}{16} 2\pi i\big)$ and $P^8 = I$,  
so $P = T$, where $T = \mathrm{diag}(1,\sqrt{i})$.

The overall phase of the operator is
$$
\omega^{12}
  = \exp\!\Big(\frac{12}{16} 2\pi i\Big)
  = -i.
$$

The $X$ component is a binary vector of length $n$,
so $\mathbf{X} \in \mathbb{Z}_2^n$.  
In this case $\mathbf{X} = 1110000$, representing $X_1 X_2 X_3$.

The $Z$ component is a vector $\mathbf{Z} \in \mathbb{Z}_8^n$.  
Here $\mathbf{Z} = 0040000$, representing $T_3^4$.

Thus
$$
\begin{aligned}
XP_8(12 \mid 1110000 \mid 0040000)
  &= \exp\!\Big(\frac{12}{16} 2\pi i\Big)\,
     X_1 X_2 X_3 T_3^4 \\
  &= -i\, X_1 X_2 X_3 Z_3 .
\end{aligned}
$$

Since the phase and $Z$ components are divisible by $4$,  
we can **rescale** $A$ and write it as a precision-2 operator by
dividing the phase and $Z$ components by $4$:
$$
XP_8(12 \mid 1110000 \mid 0040000)
  = XP_4(3 \mid 1110000 \mid 0010000).
$$